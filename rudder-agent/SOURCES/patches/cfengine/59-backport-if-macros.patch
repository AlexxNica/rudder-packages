From 6e272cba064654f8ff05bc94c0d199d068e2f8b4 Mon Sep 17 00:00:00 2001
From: Dimitrios Apostolou <dimitrios.apostolou@cfengine.com>
Date: Fri, 6 Nov 2015 23:39:25 +0100
Subject: [PATCH] Test was failing without libyaml/libxml2 support.

---
 tests/acceptance/00_basics/macros/if_feature.cf | 15 ++++++++++++---
 1 file changed, 12 insertions(+), 3 deletions(-)

diff --git a/tests/acceptance/00_basics/macros/if_feature.cf b/tests/acceptance/00_basics/macros/if_feature.cf
index 12a3e23..a47e5ac 100644
--- a/tests/acceptance/00_basics/macros/if_feature.cf
+++ b/tests/acceptance/00_basics/macros/if_feature.cf
@@ -15,12 +15,12 @@ bundle common test
 {
 @if feature(xml)
   classes:
-      "expected" expression => "any";
+      "xml" expression => "any";
 @endif
 
 @if feature(yaml)
   classes:
-      "expected2" expression => "any";
+      "yaml" expression => "any";
 @endif
 
 @if feature(unknown_123)
@@ -31,8 +31,17 @@ bundle common test
 
 bundle agent check
 {
+  vars:
+    !feature_yaml.!feature_xml::
+      "result" string => "";
+    feature_yaml.!feature_xml::
+      "result" string => "yaml";
+    !feature_yaml.feature_xml::
+      "result" string => "xml";
+    feature_yaml.feature_xml::
+      "result" string => "yaml,xml";
   methods:
-      "" usebundle => dcs_passif_expected("expected,expected2",
+      "" usebundle => dcs_passif_expected("$(result)",
                                          "not_expected",
                                          $(this.promise_filename));
 }
